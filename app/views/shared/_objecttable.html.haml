-#--
-# Copyright (C) 2013  Colin J. Fuller
-#
-# This program is free software: you can redistribute it and/or modify
-# it under the terms of the GNU Affero General Public License as published by
-# the Free Software Foundation, either version 3 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU Affero General Public License for more details.
-#
-# You should have received a copy of the GNU Affero General Public License
-# along with this program.  If not, see <http://www.gnu.org/licenses/>.
-#++

= page_entries_info @table_objects
= paginate @table_objects


%table{class: "objecttable"}
  %thead
    %tr
      %th
        - header = @controller.get_heading(@table_columns[:sort]).gsub(" ", "&nbsp;").html_safe
        %div{class: @reverse_sorted ? 'dropup' : 'dropdown'}><
          .sortable-header
            .sortable-header-group
              .sortable-header-text= header
              .sortable-header-button-container
                .btn-group><
                  %a{class: "sort-button", href: url_for(params.merge(sort_order: @reverse_sorted ? 'ASC' : 'DESC'))}
                    %span.caret

      - @table_columns[:others].each do |tc|
        %th= @controller.get_heading(tc).gsub(" ", "&nbsp;").html_safe
      - if @auth_is_rw then
        %th= ""

  %tbody
    - @table_objects.each do |obj|
      %tr.table_link{obj_url: url_for(polymorphic_path(obj, search_id: @search_id))}
        %td
          = obj.send(@table_columns[:sort])
        - @table_columns[:others].each do |tc|
          %td= obj.send(tc) 
        -if auth? :auth_write then
          %td.noclick.write-button-table-cell
            .write-button-group
              .write-button-cell
                = link_to edit_polymorphic_path(obj), class: "noclick" do
                  %i.icon-pencil.noclick
              .write-button-cell= "&nbsp;".html_safe
              .write-button-cell
                = link_to obj, confirm: "Delete #{Naming.name_for(obj.class)}#{obj.number_field}?  Are you sure?", method: :delete, class: "noclick" do
                  %i.icon-remove.noclick

= paginate @table_objects

